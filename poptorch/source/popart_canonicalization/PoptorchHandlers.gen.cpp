// DO NOT EDIT! Generated by PopTorchHandlers.py
// Copyright (c) 2020 Graphcore Ltd. All rights reserved.

#include "../PoptorchStaticInit.hpp"
#include "../PoptorchSymbols.hpp"
#include "PopartCanonicalizationUtils.hpp"
#include "poptorch/OpBuilder.hpp"
#include "poptorch_logging/Error.hpp"
#include "poptorch_logging/Logging.hpp"

namespace poptorch {

namespace {

torch::jit::Node *ipuprinttensorHandler(torch::jit::Graph *graph,
                                        torch::jit::Node *node) {
  auto x = node->input(0);
  auto s = node->input(1);
  auto t0 = constantToString(s->node());
  // printIpuTensor(x, NonTensorString(s))
  return createPrintIpuTensor(graph, x, t0);
}

} // namespace

__attribute__((constructor(HANDLER_INIT_PRIORITY))) static void registration() {
  registerHandler(symbols::poptorch::ipu_print_tensor, ipuprinttensorHandler);
}

} // namespace poptorch
